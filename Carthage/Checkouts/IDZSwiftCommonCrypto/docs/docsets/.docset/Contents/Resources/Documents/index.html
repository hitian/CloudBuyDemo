<!DOCTYPE html>
<html lang="en">
  <head>
    <title>  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
  </head>
  <body>
    <a title="  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html"> Docs</a> (100% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html"> Reference</a>
        <img id="carat" src="img/carat.png" />
          Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
          <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Cryptor.html">Cryptor</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Digest.html">Digest</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HMAC.html">HMAC</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PBKDF.html">PBKDF</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Random.html">Random</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StreamCryptor.html">StreamCryptor</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/Status.html">Status</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/CryptoDigest.html">CryptoDigest</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSData.html">NSData</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Updateable.html">Updateable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto18arrayFromHexStringFSSGSaVSs5UInt8_">arrayFromHexString(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto17dataFromByteArrayFGSaVSs5UInt8_CSo6NSData">dataFromByteArray(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto17dataFromHexStringFSSCSo6NSData">dataFromHexString(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto16hexListFromArrayFGSaVSs5UInt8_SS">hexListFromArray(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto20hexNSStringFromArrayFTGSaVSs5UInt8_9uppercaseSb_CSo8NSString">hexNSStringFromArray(_:uppercase:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F20IDZSwiftCommonCrypto18hexStringFromArrayFTGSaVSs5UInt8_9uppercaseSb_SS">hexStringFromArray(_:uppercase:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/CryptoDigest.html">CryptoDigest</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Updateable.html">Updateable</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#idzswiftcommoncrypto_a_href_https_github_com_carthage_carthage_img_src_https_img_shields_io_badge_carthage_compatible_4bc51d_svg_style_flat_alt_carthage_compatible_a_a_href_https_travis_ci_org_iosdevzone_idzswiftcommoncrypto_img_src_https_travis_ci_org_iosdevzone_idzswiftcommoncrypto_svg_branch_swift2_0_alt_build_status_a' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='idzswiftcommoncrypto_a_href_https_github_com_carthage_carthage_img_src_https_img_shields_io_badge_carthage_compatible_4bc51d_svg_style_flat_alt_carthage_compatible_a_a_href_https_travis_ci_org_iosdevzone_idzswiftcommoncrypto_img_src_https_travis_ci_org_iosdevzone_idzswiftcommoncrypto_svg_branch_swift2_0_alt_build_status_a'>IDZSwiftCommonCrypto <a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a> <a href="https://travis-ci.org/iosdevzone/IDZSwiftCommonCrypto"><img src="https://travis-ci.org/iosdevzone/IDZSwiftCommonCrypto.svg?branch=swift2.0" alt="Build Status"></a></h1>

<p>A Swift wrapper for Apple&rsquo;s <code>CommonCrypto</code> library.</p>
<a href='#using_code_idzswiftcommoncrypto_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='using_code_idzswiftcommoncrypto_code'>Using <code>IDZSwiftCommonCrypto</code></h1>

<p>There are three ways to add IDZCommonCrypto to your project:
* Use CocoaPods
* Use Carthage
* Manually</p>
<a href='#cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='cocoapods'>CocoaPods</h2>

<p>If you are using CocoaPods, add the following to your Podfile:
<code>bash
pod &#39;IDZSwiftCommonCrypto`
</code></p>

<p>Then, run the following command to install the IDZSwiftCommonCrypto pod: 
<code>bash
pod install
</code></p>
<a href='#carthage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='carthage'>Carthage</h2>

<p>If you are using Carthage, add the following to your Cartfile:</p>
<pre class="highlight shell"><code>github <span class="s2">"iosdevzone/IDZCommonCrypto"</span>
</code></pre>

<p>Run <code>carthage</code> to build the framework and drag the built &lsquo;IDZCommonCrypto.framework&rsquo; into your project or workspace.</p>
<a href='#manually' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='manually'>Manually</h2>

<p>Since <code>CommonCrypto</code> is not a standalone module, you need to generate a fake module map to convince Xcode into allowing you to <code>import CommonCrypto</code>. The <code>GenerateCommonCryptoModule</code> script provides two methods for doing this. Which method you choose depends on whether you want to able to use <code>CommonCrypto</code> and, by extension, <code>IDZSwiftCommonCrypto</code> in playgrounds.</p>

<p>To make <code>CommonCrypto</code> available to frameworks and playground use the command:
<code>bash
    ./GenerateCommonCryptoModule iphonesimulator8.0 
</code></p>

<p>This command creates a <code>CommonCrypto.framework</code> in the SDK system library directory. You should now be able to use either <code>CommonCrypto</code> or <code>IDZSwiftCommonCrypto</code> in a playground simply importing them or in your own app project by dragging the <code>IDZSwiftCommonCrypto.xcodeproj</code> into your project.</p>

<p>If you do not want to add any files to your SDK you can use the command
<code>bash
    ./GenerateCommonCryptoModule iphonesimulator8.0 .
</code>
This method creates a <code>CommonCrypto</code> directory within the <code>IDZSwiftCommonCrypto</code> source tree, so the SDK directories are not altered, but the module is not available in playgrounds. To use the framework in your own project drag the <code>IDZSwiftCommonCrypto.xcodeproj</code> into your project and set the <strong>Module Import Path</strong> to the directory containing the <code>CommonCrypto</code> directory created by the script. For more about this, see my blog post <a href="http://bit.ly/1xMAGQl">Using CommonCrypto in Swift</a> </p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">IDZSwiftCommonCrypto</span>
</code></pre>
<a href='#using_code_digest_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='using_code_digest_code'>Using <code>Digest</code></h2>

<p>To calculate a message digest you create an instance of <code>Digest</code>, call <code>update</code> one or more times with the data over which the digest is being calculated and finally call <code>final</code> to obtain the digest itself.</p>

<p>The <code>update</code> method can take a <code>String</code>
&ldquo;`swift
let  s = <q>The quick brown fox jumps over the lazy dog.</q>
var md5s2 : Digest = Digest(algorithm:.MD5)
md5s2.update(s)
let digests2 = md5s2.final()</p>

<p>// According to Wikipedia this should be
// e4d909c290d0fb1ca068ffaddf22cbd0
hexStringFromArray(digests2)
assert(digests2 == arrayFromHexString(<q>e4d909c290d0fb1ca068ffaddf22cbd0</q>))
<code>
or an array of `UInt8` elements:
</code>swift
let b : [UInt8] = 
[0x54,0x68,0x65,0x20,0x71,0x75,0x69,0x63,
0x6b,0x20,0x62,0x72,0x6f,0x77,0x6e,0x20,
0x66,0x6f,0x78,0x2e]
var md5s1 : Digest = Digest(algorithm:.MD5)
md5s1.update(b)
let digests1 = md5s1.final()
&rdquo;`</p>

<p>If you only have a single buffer you can simply write
<code>swift
  var digests3 = Digest(algorithm: .MD5).update(b)?.final() // digest is of type [UInt8]?
</code>
or 
<code>swift
  var digests4 = Digest(algorithm: .MD5).update(s)?.final() // digest is of type [UInt8]?
</code></p>
<a href='#supported_algorithms' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='supported_algorithms'>Supported Algorithms</h3>

<p>The <code>Digest</code> class supports the following algorithms:</p>

<ul>
<li><code>.MD2</code></li>
<li><code>.MD4</code></li>
<li><code>.MD5</code></li>
<li><code>.SHA1</code></li>
<li><code>.SHA224</code></li>
<li><code>.SHA256</code></li>
<li><code>.SHA384</code></li>
<li><code>.SHA512</code></li>
</ul>
<a href='#using_code_hmac_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='using_code_hmac_code'>Using <code>HMAC</code></h2>

<p>Calculating a keyed-Hash Message Authentication Code (HMAC) is very similar to calculating a message digest, except that the initialization routine now takes a key as well as an algorithm parameter.</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">keys5</span> <span class="o">=</span> <span class="nf">arrayFromHexString</span><span class="p">(</span><span class="s">"0102030405060708090a0b0c0d0e0f10111213141516171819"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">datas5</span> <span class="p">:</span> <span class="p">[</span><span class="kt">UInt8</span><span class="p">]</span> <span class="o">=</span> <span class="kt">Array</span><span class="p">(</span><span class="nv">count</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="nv">repeatedValue</span><span class="p">:</span><span class="mh">0xcd</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">expecteds5</span> <span class="o">=</span> <span class="nf">arrayFromHexString</span><span class="p">(</span><span class="s">"4c9007f4026250c6bc8414f9bf50c86c2d7235da"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">hmacs5</span> <span class="o">=</span> <span class="kt">HMAC</span><span class="p">(</span><span class="nv">algorithm</span><span class="p">:</span><span class="o">.</span><span class="kt">SHA1</span><span class="p">,</span> <span class="nv">key</span><span class="p">:</span><span class="n">keys5</span><span class="p">)</span><span class="o">.</span><span class="nf">update</span><span class="p">(</span><span class="n">datas5</span><span class="p">)?</span><span class="o">.</span><span class="nf">final</span><span class="p">()</span>

<span class="c1">// RFC2202 says this should be 4c9007f4026250c6bc8414f9bf50c86c2d7235da
</span><span class="k">let</span> <span class="nv">expectedRFC2202</span> <span class="o">=</span> <span class="nf">arrayFromHexString</span><span class="p">(</span><span class="s">"4c9007f4026250c6bc8414f9bf50c86c2d7235da"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">hmacs5</span><span class="o">!</span> <span class="o">==</span> <span class="n">expectedRFC2202</span><span class="p">)</span>
</code></pre>
<a href='#supported_algorithms' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='supported_algorithms'>Supported Algorithms</h3>

<ul>
<li>SHA1</li>
<li>MD5</li>
<li>SHA224</li>
<li>SHA256</li>
<li>SHA384</li>
<li>SHA512</li>
</ul>
<a href='#using_code_cryptor_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='using_code_cryptor_code'>Using <code>Cryptor</code></h2>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">key</span> <span class="o">=</span> <span class="nf">arrayFromHexString</span><span class="p">(</span><span class="s">"2b7e151628aed2a6abf7158809cf4f3c"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">plainText</span> <span class="o">=</span> <span class="s">"The quick brown fox jumps over the lazy dog. The fox has more or less had it at this point."</span>

<span class="k">var</span> <span class="nv">cryptor</span> <span class="o">=</span> <span class="kt">Cryptor</span><span class="p">(</span><span class="nv">operation</span><span class="p">:</span><span class="o">.</span><span class="kt">Encrypt</span><span class="p">,</span> <span class="nv">algorithm</span><span class="p">:</span><span class="o">.</span><span class="kt">AES</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span><span class="o">.</span><span class="kt">PKCS7Padding</span><span class="p">,</span> <span class="nv">key</span><span class="p">:</span><span class="n">key</span><span class="p">,</span> <span class="nv">iv</span><span class="p">:</span><span class="kt">Array</span><span class="o">&lt;</span><span class="kt">UInt8</span><span class="o">&gt;</span><span class="p">())</span>
<span class="k">var</span> <span class="nv">cipherText</span> <span class="o">=</span> <span class="n">cryptor</span><span class="o">.</span><span class="nf">update</span><span class="p">(</span><span class="n">plainText</span><span class="p">)?</span><span class="o">.</span><span class="nf">final</span><span class="p">()</span>

<span class="n">cryptor</span> <span class="o">=</span> <span class="kt">Cryptor</span><span class="p">(</span><span class="nv">operation</span><span class="p">:</span><span class="o">.</span><span class="kt">Decrypt</span><span class="p">,</span> <span class="nv">algorithm</span><span class="p">:</span><span class="o">.</span><span class="kt">AES</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span><span class="o">.</span><span class="kt">PKCS7Padding</span><span class="p">,</span> <span class="nv">key</span><span class="p">:</span><span class="n">key</span><span class="p">,</span> <span class="nv">iv</span><span class="p">:</span><span class="kt">Array</span><span class="o">&lt;</span><span class="kt">UInt8</span><span class="o">&gt;</span><span class="p">())</span>
<span class="k">var</span> <span class="nv">decryptedPlainText</span> <span class="o">=</span> <span class="n">cryptor</span><span class="o">.</span><span class="nf">update</span><span class="p">(</span><span class="n">cipherText</span><span class="o">!</span><span class="p">)?</span><span class="o">.</span><span class="nf">final</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">decryptedString</span> <span class="o">=</span> <span class="n">decryptedPlainText</span><span class="o">!.</span><span class="nf">reduce</span><span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="kt">UnicodeScalar</span><span class="p">(</span><span class="nv">$1</span><span class="p">))</span> <span class="p">}</span>
<span class="n">decryptedString</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">decryptedString</span> <span class="o">==</span> <span class="n">plainText</span><span class="p">)</span>
</code></pre>
<a href='#supported_algorithms' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='supported_algorithms'>Supported Algorithms</h3>

<ul>
<li><code>.AES</code></li>
<li><code>.DES</code></li>
<li><code>.TripleDES</code></li>
<li><code>.CAST</code></li>
<li><code>.RC2</code></li>
<li><code>.Blowfish</code></li>
</ul>
<a href='#using_code_streamcryptor_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='using_code_streamcryptor_code'>Using <code>StreamCryptor</code></h2>

<p>To encrypt a large file or a network stream use <code>StreamCryptor</code>. The <code>StreamCryptor</code> class does not accumulate the encrypted or decrypted data, instead each call to <code>update</code> produces an output buffer. </p>

<p>The example below shows how to use <code>StreamCryptor</code> to encrypt and decrypt an image file.
&ldquo;`swift
func crypt(sc : StreamCryptor,  inputStream: NSInputStream, outputStream: NSOutputStream, bufferSize: Int)
{
    var inputBuffer = Array<UInt8>(count:1024, repeatedValue:0)
    var outputBuffer = Array<UInt8>(count:1024, repeatedValue:0)
    inputStream.open()
    outputStream.open()</p>
<pre class="highlight plaintext"><code>var cryptedBytes : UInt = 0    
while inputStream.hasBytesAvailable
{
    let bytesRead = inputStream.read(&amp;inputBuffer, maxLength: inputBuffer.count)
    let status = sc.update(inputBuffer, byteCountIn: UInt(bytesRead), bufferOut: &amp;outputBuffer, byteCapacityOut: UInt(outputBuffer.count), byteCountOut: &amp;cryptedBytes)
    assert(status == Status.Success)
    if(cryptedBytes &gt; 0)
    {
        let bytesWritten = outputStream.write(outputBuffer, maxLength: Int(cryptedBytes))
        assert(bytesWritten == Int(cryptedBytes))
    }
}
let status = sc.final(&amp;outputBuffer, byteCapacityOut: UInt(outputBuffer.count), byteCountOut: &amp;cryptedBytes)    
assert(status == Status.Success)
if(cryptedBytes &gt; 0)
{
    let bytesWritten = outputStream.write(outputBuffer, maxLength: Int(cryptedBytes))
    assert(bytesWritten == Int(cryptedBytes))
}
inputStream.close()
outputStream.close()
</code></pre>

<p>}</p>

<p>let imagePath = NSBundle.mainBundle().pathForResource(<q>Riscal</q>, ofType:<q>jpg</q>)!
let tmp = NSTemporaryDirectory()
let encryptedFilePath = tmp.stringByAppendingPathComponent(<q>Riscal.xjpgx</q>)
var decryptedFilePath = tmp.stringByAppendingPathComponent(<q>RiscalDecrypted.jpg</q>)</p>

<p>var imageInputStream = NSInputStream(fileAtPath: imagePath)
var encryptedFileOutputStream = NSOutputStream(toFileAtPath: encryptedFilePath, append:false)
var encryptedFileInputStream = NSInputStream(fileAtPath: encryptedFilePath)
var decryptedFileOutputStream = NSOutputStream(toFileAtPath: decryptedFilePath, append:false)</p>

<p>var sc = StreamCryptor(operation:.Encrypt, algorithm:.AES, options:.PKCS7Padding, key:key, iv:Array<UInt8>())
crypt(sc, imageInputStream, encryptedFileOutputStream, 1024)</p>

<p>// Uncomment this line to verify that the file is encrypted
//var encryptedImage = UIImage(contentsOfFile:encryptedFile)</p>

<p>sc = StreamCryptor(operation:.Decrypt, algorithm:.AES, options:.PKCS7Padding, key:key, iv:Array<UInt8>())
crypt(sc, encryptedFileInputStream, decryptedFileOutputStream, 1024)</p>

<p>var image = UIImage(named:<q>Riscal.jpg</q>)
var decryptedImage = UIImage(contentsOfFile:decryptedFilePath)
&rdquo;`</p>
<a href='#using_code_pbkdf_code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='using_code_pbkdf_code'>Using <code>PBKDF</code></h2>

<p>The <code>PBKDF</code> class provides a method of deriving keys from a user password. 
The following example derives a 20-byte key:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">keys6</span> <span class="o">=</span> <span class="kt">PBKDF</span><span class="o">.</span><span class="nf">deriveKey</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span> <span class="nv">salt</span><span class="p">:</span> <span class="s">"salt"</span><span class="p">,</span> <span class="nv">prf</span><span class="p">:</span> <span class="o">.</span><span class="kt">SHA1</span><span class="p">,</span> <span class="nv">rounds</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">derivedKeyLength</span><span class="p">:</span> <span class="mi">20</span><span class="p">)</span>
<span class="c1">// RFC 6070 - Should derive 0c60c80f961f0e71f3a9b524af6012062fe037a6
</span><span class="k">let</span> <span class="nv">expectedRFC6070</span> <span class="o">=</span> <span class="nf">arrayFromHexString</span><span class="p">(</span><span class="s">"0c60c80f961f0e71f3a9b524af6012062fe037a6"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="n">keys6</span> <span class="o">==</span> <span class="n">expectedRFC6070</span><span class="p">)</span>
</code></pre>
<a href='#supported_pseudo_random_functions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='supported_pseudo_random_functions'>Supported Pseudo-Random Functions</h3>

<ul>
<li><code>.SHA1</code></li>
<li><code>.SHA224</code></li>
<li><code>.SHA256</code></li>
<li><code>.SHA384</code></li>
<li><code>.SHA512</code></li>
</ul>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2015 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2015-10-29)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.3.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
